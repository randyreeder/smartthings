# Prevent access to parent directories and sensitive files
RewriteEngine On

# Block access to files starting with dot (., .., .env, .git, etc.)
RewriteRule ^\..*$ - [F,L]

# Block access to parent directory traversal attempts
RewriteRule \.\./.*$ - [F,L]

# Block access to specific sensitive file types
<FilesMatch "\.(ini|json|log|php~|bak|backup|old)$">
    Require all denied
</FilesMatch>

# Block access to composer and git files
<FilesMatch "(composer\.(json|lock)|\.git.*|\.env.*|bearer\.ini|userinfo\.ini)$">
    Require all denied
</FilesMatch>

# Only allow access to specific PHP files
<FilesMatch "^(json|set)\.php$">
    Require all granted
</FilesMatch>
